---
- name: Print DB info
  when: groups.db is defined
  block:
    - name: Get the DB container version info
      containers.podman.podman_container_exec:
        name: "{{ svt_db_container_name }}"
        # command: "su - db2inst1 -c db2level"
        command: db2level
        user: db2inst1
      register: dbinfo

    - name: Create local logs dir
      delegate_to: localhost
      ansible.builtin.file:
        path: "{{ logs_dir }}/{{ env_name }}"
        state: directory

    - name: Save dbinfo to db_info.json
      delegate_to: localhost
      ansible.builtin.copy:
        content: "{{ dbinfo.stdout | to_nice_json }}"
        dest: "{{ logs_dir }}/{{ env_name }}/db_info.json"
        mode: '0444'
