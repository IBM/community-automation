---

- name:  Uninstall IM 
  ignore_errors: true
  shell: "{{ cygwin }}{{ install_base }}/IM/eclipse/tools/imcl uninstallAll"
  register: uninstallOutput
  failed_when: ( uninstallOutput.rc not in [ 0, 1 ] )

- name: UninstallAll output
  debug:
   msg: "{{ uninstallOutput.stdout_lines }}"

# windoze /cygdrive/c/Users/Administrator/AppData/Roaming/IBM/Installation Manager/uninstall/userinstc
# ansible_user: Administrator
- name:  Uninstall Windoze ibm installation manager
  ignore_errors: true
  shell: "~/AppData/Roaming/IBM/Installation Manager/uninstall/userinstc"
  register: uninstallOutput
  failed_when: ( uninstallOutput.rc not in [ 0, 1 ] )
  when:
  - ansible_system == 'Windows' or 'CYG' in ansible_system

- name:  Uninstall *nix ibm installation manager
  ignore_errors: true
  shell: "~/var/ibm/InstallationManager/uninstall/uninstallc"
  register: uninstallOutput
  failed_when: ( uninstallOutput.rc not in [ 0, 1 ] )
  when:
  - ansible_system is not search('CYG') and 'CYG' not in ansible_system

- name: UninstallAll output
  debug:
   msg: "{{ uninstallOutput.stdout_lines }}"
  when: uninstallOutput.stdout_line is defined

- name: Remove IM directories
  file:
    path: "{{ item }}"
    state: absent
  with_items:
    - "{{ cygwin }}{{ install_base }}/{{ shared_dir }}"
    - "{{ cygwin }}{{ install_base }}/im_install"
    - "{{ cygwin }}{{ install_base }}/IM"
    - "{{ cygwin }}{{ install_base }}/javasharedresources"
    - "~/var/"
    - "~/etc/"
